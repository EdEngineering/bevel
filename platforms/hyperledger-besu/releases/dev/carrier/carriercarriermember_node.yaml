apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: carriercarriermember-node
  namespace: carrier-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: carriercarriermember-node
  interval: 1m
  chart:
   spec:
    chart: platforms/hyperledger-besu/charts/node_besu
    sourceRef:
      kind: GitRepository
      name: flux-dev
      namespace: flux-dev
  values:
    metadata:
      namespace: carrier-bes
      labels:
    replicaCount: 1
    staticnodes:
      - "enode://930f817c5ef136bf52a2abebda5b887610effd0df99d905a1b0de8358770b1cb4c7a7abd1d13f4fd04d6ed05dc53c0b728aa6d42edb05dc34004e1f66029d08d@validator1.test.besu.evasquezapplaudo.ml:15010"
      - "enode://347b36477104989cae0b47c17c8b61c35defd2a8352d6d3671fcdfcf3d43ff841d2fe3ba90020163721e5b0e4fb35a78b8c009dd2d7dca9693ad610068b92ec6@validator2.test.besu.evasquezapplaudo.ml:15012"
      - "enode://25b3156bb3e4c222711599d22bf75236f63ead77c6b3bc37793993acde9ad4151876a0309253c29b991454597597b7cfe1a6b4200f874708d31f59b0e8f9327c@validator3.test.besu.evasquezapplaudo.ml:15014"
      - "enode://94c29365cb020a1218036ae359507553e9cbebf2c845c2d0a27cdfd1aebdf83fb7d692b8998da0882fd4e2eb95588704a6af8b12e4d9f674f85b885e29743405@validator4.test.besu.evasquezapplaudo.ml:15016"
      - "enode://1e84b7fd3d96e3c2a6f346fedaf56346904de7a4ce53dd72dea1fa9940f0e134686596d90191606dda465305c7bf4e9cbc0a9cc319dad2c2106501bd4bf53d15@carrier.test.besu.evasquezapplaudo.ml:15020"

    liveliness_check:
      enabled: false
    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5
    proxy:
      provider: ambassador
      external_url: carrier.test.besu.evasquezapplaudo.ml
      p2p: 15020
      rpc: 15021

    images:
      node: hyperledger/besu:22.10.2
      alpineutils: ghcr.io/hyperledger/bevel-alpine:latest
      pullPolicy: IfNotPresent

    node:
      name: carrier
      consensus: ibft
      subject: O=Carrier,OU=Carrier,L=51.50/-0.13/London,C=GB
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

      permissioning:
        enabled: False

    tm:
      type: tessera
      tls: True
      url: "https://carrier-tessera.carrier-bes:8888"

    privacy:
      enabled: true
      public_key_file: /secrets/tm_key.pub
      tm_flag: true

    storage:
      storageclassname: gcpstorageclass
      storagesize: 1Gi

    vault:
      address: http://34.173.49.122:8200
      secretengine: secretsv2
      secretprefix: data/carrier-bes/crypto/carrier
      serviceaccountname: vault-auth
      keyname: data
      tmdir: tm
      tlsdir: tls
      role: vault-role
      type: hashicorp
      authpath: besucarrier

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiYWxsb2MiOiB7CiAgICAiQ2YyNTdmNDc5N0NiODE5YjJDMWNBNEYwRTMyMjFhZjM5NzM0MjFCQiI6IHsKICAgICAgImJhbGFuY2UiOiAiOTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAiCiAgICB9LAogICAgIjE2Q2Q5NTdCNzU3MDI4ZTEzMUE2MUIxYjNFMWI1RTJFNUFEM2M4MjgiOiB7CiAgICAgICJiYWxhbmNlIjogIjkwMDAwMDAwMDAwMDAwMDAwMDAwMDAwIgogICAgfQogIH0sCiAgImV4dHJhRGF0YSI6ICIweGY4N2VhMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBmODU0OTRkNzI3YmZmNzM1ZDA2MDBlNWJlM2RkODk3YTI0OTEyYjAzYmUwNzAxOTQzYzNmYmZkZTJmNTBhZmM3MzNmYTY3NjM5OTU4MGU3MmIzMTIwYWI2OTQ3MDBmNWRmNTI3MTdhZTAxNzdlMmFlMjc3NjA3M2Y1NzhhMjU1ZWUwOTQ2MDdhNzk0NzcxZWFhYWEzOTFjMjEwZTA4MTI2OTYzNTQzYmI5ODRmODA4NDAwMDAwMDAwYzAiCn0=

 

    metrics:
      enabled: False
      port: 9545
